{% load pagetools %}
{% load humanize %}
{% load ion_readable %}
{% load i18n %}

<div id="alignMap" class="span4 well centered">
	<div class="number-chunk row-fluid">
		<div class="span6">
			<h2>{{ionstats_alignment.aligned.num_bases|ion_readable}}</h2>
			<small rel='tooltip' title="{% trans "report.section.aligned.map.ionstats_alignment.aligned.num_bases.tooltip" %}">{% trans "report.section.aligned.map.ionstats_alignment.aligned.num_bases.label" %}</small>
		</div>
		<div class="span6">
			<h2>{{avg_coverage_depth_of_target}} </h2>
			<small rel='tooltip' title="{% trans "report.section.aligned.map.avg_coverage_depth_of_target.tooltip" %}">{% trans "report.section.aligned.map.avg_coverage_depth_of_target.label" %}</small>
		</div>
	</div>

    <a data-toggle="modal" class="report-metric-visual showImg" href="#alignRate">
       <img class="showImg" src="{{report.reportWebLink}}/alignment_rate_plot.png"> <i class="icon-zoom-in"></i>
    </a>
  <table class="table table-striped">
    <thead>
      <tr>
        <th>&nbsp;</th>
        <th style="text-align: right;">{% trans "report.section.aligned.map.column.count" %}</th>
        <th style="text-align: right;">{% trans "report.section.aligned.map.column.percentage" %}</th>
      </tr>
    </thead>
    <tbody>
      {% if ionstats_alignment %}
      <tr>
        <td rel="tooltip" title="{% trans "report.section.aligned.map.ionstats_alignment.full.num_reads.tooltip" %}">{% trans "report.section.aligned.map.ionstats_alignment.full.num_reads.label" %}</td>
        <td style="text-align: right;">{{ionstats_alignment.full.num_reads|intcomma}}</td>
        <td style="text-align: right;">&nbsp;&mdash;&nbsp;</td>
      </tr>
      <tr>
        <td rel="tooltip" title="{% trans "report.section.aligned.map.ionstats_alignment.aligned.num_reads.tooltip" %}">{% trans "report.section.aligned.map.ionstats_alignment.aligned.num_reads.label" %}</td>
        <td style="text-align: right;">{{ionstats_alignment.aligned.num_reads|intcomma}}</td>
        <td style="text-align: right;">{{ionstats_alignment.aligned.p_num_reads|floatformat:"1"}}%</td>
      </tr>
      <tr>
        <td rel="tooltip" title="{% trans "report.section.aligned.map.ionstats_alignment.unaligned.num_reads.tooltip" %}">{% trans "report.section.aligned.map.ionstats_alignment.unaligned.num_reads.label" %}</td>
        <td style="text-align: right;">{{ionstats_alignment.unaligned.num_reads|intcomma}}</td>
        <td style="text-align: right;">{{ionstats_alignment.unaligned.p_num_reads|stringformat:".1f"}}%</td>
      </tr>
      {% endif %}
      {% if duplicate_metrics %}
      <tr>
        <td rel="tooltip" title="{% trans "report.section.aligned.map.duplicate_metrics.duplicate_reads.tooltip" %}">{% trans "report.section.aligned.map.duplicate_metrics.duplicate_reads.label" %}</td>
        <td style="text-align: right;">{{duplicate_metrics.duplicate_reads|intcomma}}</td>
        <td style="text-align: right;">{{duplicate_metrics.duplicate_read_percentage|stringformat:".1f"}}%</td>
      </tr>
      {% endif %}
    </tbody>
  </table>

    <div class="modal hide" id="alignRate" style="width: 830px; margin-left: -415px;">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h3>{% trans "report.section.aligned.map.summary.title" %}</h3>
        </div>
        <div class="modal-body" id="alignRate_body" style="max-height: 900px;">
            <img style="width: 770px;" src="{{report.reportWebLink}}/large_alignment_rate_plot.png">
        </div>
        <div class="modal-footer">
            <a href="#" class="btn" data-dismiss="modal">{% trans "global.action.modal.close" %}</a>
        </div>
    </div>

</div>
